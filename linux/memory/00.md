# 0x00. 导读

1. 不明白为什么要有内存模型
2. 

# 0x01. 简介

[内存管理](https://carlyleliu.github.io/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/)

如何讲好内存这个故事，学习过程中我也迷茫了很久。  

## 1.1 内存分段和内存分页

why:  
CPU 的作用抽象来说是读取指令、执行指令、返回结果，指令中很可能涉及读取数据，读取数据就需要地址，去到某个地址拿数据回来。这个地址是直接用物理地址吗？如何管理这些地址？

what & how:    
[内存分段和内存分页](./01.md) 

内存分段已经成为历史，内存分页将内存分为 4kb 大小的页，并引入虚拟地址，这带来了：
- 虚拟地址空间  
- VA 与 PA 的转换  

### 1.1.1 地址空间

虚拟地址有很大的文章可以做，就和人的身份证一样，编码的时候前面几位就能知道你是哪个省份，后面还包含了你的出生年月。同样的，这些地址如何产生、如何解读，就产生了很丰富的概念。[Linux 内存虚拟和物理地址空间](./memory_system00.md)

### 1.1.2 VA -> PA

VA 转为 PA 是通过查找 PageTable 。为了优化 PageTable 的存储空间，引入多级 PageTable 。  

为了加快查找过程，引入 Cache( [cache详解](./cache00.md) ) 、 MMU(TLB + Table Walk Unit) 、 Huge Table 等。  

## 1.2 内存模型

why:  
从硬件上来说，内存就是一块存储物质，为了便述，想象上面有很多个小孔，可以存放东西。系统启动之后，操作系统自己该如何使用它，又如何管理其它进程使用。

what:  
对于内核来说，会把物理内存切分为均匀小块，每块大小是 **4KB** ，使用 `struct page` 来管理，那么就会有数量巨大的 `struct page` 需要管理。有三种管理方法，这些管理方法就是 内存模型。

how:  
[内存模型](./memory_system04.md) 

